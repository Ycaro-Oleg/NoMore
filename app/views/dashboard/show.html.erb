<div class="space-y-8">
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-3xl font-bold text-white">Dashboard</h1>
      <p class="mt-1 text-gray-400">Your commitments are watching. No more excuses.</p>
    </div>
    <%= link_to new_commitment_path, class: "inline-flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2.5 text-sm font-semibold text-white hover:bg-red-500 transition" do %>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
      </svg>
      New Commitment
    <% end %>
  </div>

  <!-- Analytics Cards -->
  <div class="grid grid-cols-2 gap-4 sm:grid-cols-4">
    <div class="rounded-xl border border-gray-800 bg-gray-900 p-4">
      <p class="text-xs font-medium uppercase tracking-wider text-gray-500">Total</p>
      <p class="mt-1 text-2xl font-bold text-white"><%= @analytics.total_count %></p>
    </div>
    <div class="rounded-xl border border-gray-800 bg-gray-900 p-4">
      <p class="text-xs font-medium uppercase tracking-wider text-gray-500">Completion</p>
      <p class="mt-1 text-2xl font-bold text-green-400"><%= @analytics.completion_rate %>%</p>
      <div class="mt-2 h-1.5 w-full rounded-full bg-gray-800">
        <div class="h-1.5 rounded-full bg-green-500" style="width: <%= @analytics.completion_rate %>%"></div>
      </div>
    </div>
    <div class="rounded-xl border border-gray-800 bg-gray-900 p-4">
      <p class="text-xs font-medium uppercase tracking-wider text-gray-500">Failed</p>
      <p class="mt-1 text-2xl font-bold text-red-400"><%= @analytics.fail_rate %>%</p>
      <div class="mt-2 h-1.5 w-full rounded-full bg-gray-800">
        <div class="h-1.5 rounded-full bg-red-500" style="width: <%= @analytics.fail_rate %>%"></div>
      </div>
    </div>
    <div class="rounded-xl border border-gray-800 bg-gray-900 p-4">
      <p class="text-xs font-medium uppercase tracking-wider text-gray-500">Streak</p>
      <p class="mt-1 text-2xl font-bold text-amber-400"><%= @analytics.current_streak %></p>
    </div>
  </div>

  <% if @analytics.worst_category.present? %>
    <div class="rounded-lg border border-amber-800/50 bg-amber-900/20 p-3 text-sm text-amber-300">
      Your worst category is <strong><%= @analytics.worst_category %></strong> â€” maybe stop pretending you'll do it.
    </div>
  <% end %>

  <!-- Active Commitments -->
  <div>
    <h2 class="text-lg font-semibold text-white mb-4">Active Commitments</h2>

    <% if @active_commitments.any? %>
      <div class="space-y-3" id="active-commitments">
        <% @active_commitments.each do |commitment| %>
          <%= render partial: "commitments/commitment", locals: { commitment: commitment } %>
        <% end %>
      </div>
    <% else %>
      <div class="rounded-xl border border-gray-800 bg-gray-900 p-8 text-center">
        <p class="text-gray-400">No active commitments. What are you waiting for?</p>
        <%= link_to "Make a commitment", new_commitment_path, class: "mt-3 inline-block text-red-400 hover:text-red-300 text-sm" %>
      </div>
    <% end %>
  </div>

  <!-- Recent History -->
  <% completed_and_failed = @commitments.where(status: [:completed, :failed]).limit(5) %>
  <% if completed_and_failed.any? %>
    <div>
      <h2 class="text-lg font-semibold text-white mb-4">Recent History</h2>
      <div class="space-y-3">
        <% completed_and_failed.each do |commitment| %>
          <%= render partial: "commitments/commitment", locals: { commitment: commitment } %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
